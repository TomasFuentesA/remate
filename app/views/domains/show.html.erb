<div class="container">
  <div class="row">
    <div class="col-sm-12 card card-body">
      <div class="row">
        <div class="col-md-6">
          <label for="name"> Modalidad: </label>
          <input type="text" id="name" class="form-control" placeholder="Name" disable
            value="<%= @domain.type_modality %>" readonly>
        </div>
        <div class="col-md-6">
          <label for="name"> Porcentaje </label>
          <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= @domain.percentage %>"
            readonly>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <label for="name"> Precio: </label>
          <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= @domain.price %>"
            readonly>
        </div>
        <div class="col-md-6">
          <label for="name"> Fecha de posesion </label>
          <input type="text" id="name" class="form-control" placeholder="Name" disable
            value="<%= @domain.date_posetion %>" readonly>
        </div>
      </div>
      <div class="row">
        <%if @domain.type_modality == "Creacion de empresa"%>
          <div class="col-md-12">
          <label for="name"> Creador(es): </label>
          <% DomainRol.order(:id).each do |domrol| %>
            <% if domrol.domain_id == @domain.id %>
              <% if domrol.type_rol == "Creador"%>
                <% if domrol.type_member == "Natural" %>
                  <% Persona.order(:id).each do |persona| %>
                    <% if persona.id == domrol.persona_id%>
                      <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= persona.name%> <%= persona.last_name1%>/<%= persona.rut%> " readonly>
                      <% @legal_persona = LegalPersona.find(@domain.domainable_id) %>
                      <br>
                      <%= link_to "Añadir Persona", new_legal_persona_domain_rol_persona_member_path(@legal_persona.id, domrol.id) ,class:"btn btn-primary"%>
                      <%= link_to 'Edit', edit_domain_rol_path(domrol), class: "btn btn-warning" %>
                      <%= link_to 'Destroy', domrol, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-danger"  %>
                    <%end%>
                  <%end%>
                <%else%>
                  <% LegalPersona.order(:id).each do |legalpersona| %>
                    <% if legalpersona.id == domrol.persona_id%>
                      <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= legalpersona.name%>/<%= legalpersona.rut%>" readonly>
                      <% @legal_persona = LegalPersona.find(@domain.domainable_id) %>
                      <br>
                      <%= link_to "Añadir Persona", new_legal_persona_domain_rol_persona_member_path(@legal_persona.id, domrol.id) ,class:"btn btn-primary"%>
                      <%= link_to 'Edit', edit_domain_rol_path(domrol), class: "btn btn-warning"  %>
                      <%= link_to 'Destroy', domrol, method: :delete, data: { confirm: 'Are you sure?' },class: "btn btn-danger" %>
                    <%end%>
                  <%end%>
                <%end%>
              <%end%>
            <%end%>
          <%end%>
          </div>
        <%elsif @domain.type_modality == "Modificacion de empresa"%>
          <div class="col-md-12">
          <label for="name"> Modificador(es): </label>
          <% DomainRol.order(:id).each do |domrol| %>
            <% if domrol.domain_id == @domain.id %>
              <% if domrol.type_rol == "Modificador"%>
                <% if domrol.type_member == "Natural" %>
                  <% Persona.order(:id).each do |persona| %>
                    <% if persona.id == domrol.persona_id%>
                      <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= persona.name%> <%= persona.last_name1%>/<%= persona.rut%> " readonly>
                      <br>
                      <% @legal_persona = LegalPersona.find(@domain.domainable_id) %>
                    <%end%>
                  <%end%>
                <%else%>
                  <% LegalPersona.order(:id).each do |legalpersona| %>
                    <% if legalpersona.id == domrol.persona_id%>
                      <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= legalpersona.name%>/<%= legalpersona.rut%>" readonly>
                      <br>
                      <% @legal_persona = LegalPersona.find(@domain.domainable_id) %>
                    <%end%>
                  <%end%>
                <%end%>
              <%end%>
            <%end%>
          <%end%>
          </div>
        <%else%>
          <div class="col-md-6">
            <label for="name"> Vendedor(es): </label>
            <% DomainRol.order(:id).each do |domrol| %>
              <% if domrol.domain_id == @domain.id %>
                <% if domrol.type_rol == "Vendedor"%>
                  <% if domrol.type_member == "Natural" %>
                    <% Persona.order(:id).each do |persona| %>
                      <% if persona.id == domrol.persona_id%>
                        <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= persona.name%> <%= persona.last_name1%>/<%= persona.rut%> " readonly>
                        <br>
                        <% @legal_persona = LegalPersona.find(@domain.domainable_id) %>
                        <%= link_to 'Añadir Comprador', new_domain_rol_comprador_path(domrol), class: "btn btn-success" %>
                      <%end%>
                    <%end%>
                  <%else%>
                    <% LegalPersona.order(:id).each do |legalpersona| %>
                      <% if legalpersona.id == domrol.persona_id%>
                        <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= legalpersona.name%>/<%= legalpersona.rut%>" readonly>
                        <br>
                        <% @legal_persona = LegalPersona.find(@domain.domainable_id) %>
                        <%= link_to 'Añadir comprador', new_domain_rol_comprador_path(domrol), class: "btn btn-success" %>
                      <%end%>
                    <%end%>
                  <%end%>
                <%end%>
              <%end%>
            <%end%>
          </div>
        <%end%>        
        <div class="col-md-4">
        <% if @domain.type_modality == "Compra y Venta de acciones"%>
          <label for="name"> Comprador(es): </label>
          <% DomainRol.order(:id).each do |domrol| %>
            <% if domrol.domain_id == @domain.id %>
              <% Comprador.order(:id).each do |comp| %>
                <% if comp.domain_rol_id == domrol.id %>
                  <% if comp.type_member == "Natural" %>
                    <% Persona.order(:id).each do |perso| %>
                      <% if comp.persona_id == perso.id %>
                        <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= perso.name%>/<%= perso.last_name1%>" readonly>
                        <%= link_to "Añadir Persona", new_legal_persona_comprador_persona_member_path(@legal_persona.id, comp.id) ,class:"btn btn-primary"%>
                      <%end%>
                    <%end%>
                  <%else%>
                    <% LegalPersona.order(:id).each do |legalp| %>
                      <% if comp.persona_id == legalp.id %>
                        <input type="text" id="name" class="form-control" placeholder="Name" disable value="<%= legalp.name%>/<%= legalp.rut%>" readonly>
                        <%= link_to "Añadir Persona", new_legal_persona_comprador_persona_member_path(@legal_persona.id, comp.id) ,class:"btn btn-primary"%>    
                      <%end%>
                    <%end%>
                  <%end%>
                <%end%>      
              <%end%>    
            <%end%>    
          <%end%>
        <%end%>  
        </div> 
      </div> 
    </div>
  </div>
</div>
<div class= "container">
  <div class= "row">
    <div class= "col-sm-12 card card-body">
      <% LegalPersona.order(:id).each do |legalp| %>
        <% if legalp.id == @domain.domainable_id%>
          Documentos de <%= legalp.name %>
        <%end%>
      <%end%>    
      <br>
      <%= link_to new_domain_domainfile_path(@domain), class: "btn btn-primary" do %>
      <%= fa_icon "plus"%> Nuevo documento
      <% end %>
      <br>
      <table class= "table table-bordered table-hover">
        <thead class= "thead-dark">
          <tr>
          <th scope= "col">Documento</th>
          <th scope= "col">Observacion</th>
          <th scope= "col">Opciones</th>
          </tr>
        </thead>
        <tbody class= "rounded-pill">
          <% Domainfile.order(:id).each do |domfiles|%>
            <% if domfiles.domain_id == @domain.id%>
            <tr>
              <% if domfiles.file_name != "" %>
                <td scope= "row"><%= link_to domfiles.file_name.to_s.split('/')[5], File.join(root_url.to_s,domfiles.file_name.to_s)%> </td>
              <%else %>
                <td scope= "row">Sin Archivo</td>
              <% end %>
              <td><%= domfiles.obs_string %></td>
              <td>
                <%= link_to 'Ver', domfiles , class: "btn btn-info" %>
                <%= link_to 'Edit', edit_domainfile_path(domfiles) , class: "btn btn-warning" %>
                <%= link_to 'Borrar', domfiles, method: :delete, data: { confirm: 'Esta seguro?' } ,class: "btn btn-danger"%>
              </td>
            </tr>
            <%end%>
          <%end%>
      </table>
    </div>
  </div>
</div>
<div class="container">
  <% unless @domain.inscriptions.nil? %>
  <div class="row">
    <div class="col-sm-12 card card-body">
      <% LegalPersona.order(:id).each do |legalp| %>
        <% if legalp.id == @domain.domainable_id%>
          Inscripciones de <%= legalp.name %>
        <%end%>
      <%end%>  
      <br>
      <%= link_to new_domain_inscription_path(@domain),class: "btn btn-primary" do%>
      <%= fa_icon "plus"%> Nueva Inscripcion
      <% end %>
      <br>
      <table class="table table-bordered table-hover">
        <thead class="thead-dark">
          <tr>
            <th scope="col">foja</th>
            <th scope="col">número</th>
            <th scope="col">año</th>
            <th scope="col">cbrs</th>
            <th scope="col">Opciones</th>
          </tr>
        </thead>
        <tbody class="rounded-pill">
          <% @domain.inscriptions.each do |inscription| %>
          <tr>
            <td scope="row"><%= inscription.foja %></td>
            <td><%= inscription.number %></td>
            <td><%= inscription.year %></td>
            <td><%= inscription.cbrs %></td>
            <td>
              <%= link_to 'ver', inscription ,class: "btn btn-info"%>
              <%= link_to 'editar', edit_domain_inscription_path(inscription),class: "btn btn-warning" %>
            </td>
          </tr>
          <%end%>
        </tbody>
        </thead>
      </table>
    </div>
  </div>
  <% end %>
</div>